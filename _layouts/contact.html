---
layout: default
---

<script src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript'>
  function onSubmit(){
    
    var action = 'https://openwhisk.ng.bluemix.net/api/v1/web/christopher.knowles%40roads.vic.gov.au_dev/default/form.json';
    var form = document.getElementById('contact_form');
    
    var data = {
      'name' : form['name'].value,
      'email' : form['email'].value,
      'phone' : form['phone'].value,
      'message' : form['message'].value,
      'g-recaptcha-response' : form['g-recaptcha-response'].value
    }
    
    // example request with data object
    postAjax(action, data, function(response){ 
      console.log(response); 
      
      try {
        var j = json.parse(response);
      } catch(e) {
        var j = {
          'success' : false,
          'message' : 'Something went wrong submitting your form'
        }
      }
      
      if (j.success) {
        console.log(form['response'].value);
        window.location.href = form['response'].value;
      } else {
        document.getElementById('error').innerText = j.message;
      }
      
    });
    
  } 
  
  function postAjax(url, data, success) {
    var params = typeof data == 'string' ? data : Object.keys(data).map(
            function(k){ return encodeURIComponent(k) + '=' + encodeURIComponent(data[k]) }
        ).join('&');

    var xhr = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
    xhr.open('POST', url);
    xhr.onreadystatechange = function() {
        if (xhr.readyState>3 && (xhr.status==200 || xhr.status==201)) { success(xhr.responseText); }
    };
    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xhr.send(params);
    return xhr;
}
 
</script>  

<style>
  .control {
    margin: 1rem 0;
  }
  
  label {
    display: block;
    margin-bottom: 0.5rem;
  }
  
  .text {
    width: 60%; 
    max-width: 60%;
  }
  
  .phone {
   width: 200px; 
  }
  
  .textarea {
    width: 60%;
    height: 300px;
  }
  
</style>  

<div class="post">
  <h1>{{ page.title }}</h1>
  
  <p id='error'></p>
  
  <p>If you'd like to get in touch, we'd love to hear from you.</p>
  <p>Complete the form below and we'll get back to you.</p>

  <form id="contact_form" method="post" action="">
    <input type="hidden" name="response" value="contact-response.html">
    
    <div class="control">
      <label>Your name</label>
      <input class="text" type="text" name="name" required> 
    </div>
    
    <div class="control">
      <label>Your email address</label>
      <input class="text" type="text" name="email" required email> 
    </div>
    
    <div class="control">
      <label>Your contact number (optional)</label>
      <input class="text phone" type="text" name="phone"> 
    </div>   
    
     <div class="control">
      <label>Your message</label>
      <textarea class="textarea" name="message"></textarea> 
    </div>      
    
    <button
      class="g-recaptcha"
      data-sitekey="6Lcke1YUAAAAAMs34BfCP767CNnrHZEcmcleY0XR"
      data-callback="onSubmit">
      Submit
    </button>
  
  </form>

</div>
